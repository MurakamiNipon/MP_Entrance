<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final Decision</title>
    <link rel="icon" type="image/png" href="../Img/Icon_logo.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="written_exam_report.css">
</head>
<body>

    <div class="top-bar">
        <div class="brand">
            <img src="../Img/Icon_logo.png" alt="Logo" onerror="this.style.display='none'">
            <div class="brand-text">
                <h1>Medical Physics Candidate Entrance Examination (Final Decision)</h1>
            </div>
        </div>
        <div class="action-group">
            <button class="btn-modern btn-export" onclick="exportToExcel()">
                <i class="fas fa-file-excel"></i> Export All
            </button>
            <button class="btn-modern btn-back" onclick="window.history.back()">
                <i class="fas fa-arrow-left"></i> ย้อนกลับ
            </button>
        </div>
    </div>

    <div class="container">

        <div class="tabs-container">
            <div class="tabs-wrapper">
                <button class="tab-btn active" onclick="switchTab('phy', this)">Physics</button>
                <button class="tab-btn" onclick="switchTab('math', this)">Mathematics</button>
                <button class="tab-btn" onclick="switchTab('rad', this)">Radiation</button>
                <button class="tab-btn eng-tab" onclick="switchTab('eng', this)">English Score</button>
                <button class="tab-btn grp-tab" onclick="switchTab('grp', this)">Group Assessment</button>
                <button class="tab-btn" onclick="switchTab('sum', this)">Summary (คะแนนรวม)</button>
                <button class="tab-btn final-tab" onclick="switchTab('final', this)"><i class="fas fa-star" style="margin-right:5px;"></i> Final Decision</button>
            </div>
        </div>

        <div id="view-phy" class="tab-content active">
            <div class="sheet-card">
                <div class="table-responsive">
                    <table id="tablePhy">
                        <thead>
                            <tr>
                                <th rowspan="2" class="col-sticky-1">ลำดับ</th>
                                <th rowspan="2" class="col-sticky-2">ชื่อ - นามสกุล</th>
                                <th rowspan="2" style="min-width:180px;">มหาวิทยาลัย</th>
                                <th rowspan="2" style="min-width:180px;">สาขา</th>
                                <th colspan="4" class="th-group">Classical mechanics</th>
                                <th colspan="4" class="th-group">Electromagnetics</th>
                                <th colspan="4" class="th-group">Quantum mechanics</th>
                            </tr>
                            <tr>
                                <th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th>
                                <th>7</th><th>8</th><th>9</th><th>10</th><th>11</th><th>12</th>
                            </tr>
                        </thead>
                        <tbody id="tbodyPhy"><tr><td colspan="16">Loading...</td></tr></tbody>
                        <tfoot id="tfootPhy"></tfoot>
                    </table>
                </div>
            </div>
        </div>

        <div id="view-math" class="tab-content">
            <div class="sheet-card">
                <div class="table-responsive">
                    <table id="tableMath">
                        <thead>
                            <tr>
                                <th rowspan="2" class="col-sticky-1">ลำดับ</th>
                                <th rowspan="2" class="col-sticky-2">ชื่อ - นามสกุล</th>
                                <th rowspan="2" style="min-width:180px;">มหาวิทยาลัย</th>
                                <th rowspan="2" style="min-width:180px;">สาขา</th>
                                <th colspan="4" class="th-group">Calculus</th>
                                <th colspan="3" class="th-group">Linear Algebra</th>
                                <th colspan="3" class="th-group">Prob & Stat</th>
                            </tr>
                            <tr>
                                <th>13</th><th>14</th><th>15</th><th>16</th><th>17</th>
                                <th>18</th><th>19</th><th>20</th><th>21</th><th>22</th>
                            </tr>
                        </thead>
                        <tbody id="tbodyMath"></tbody>
                        <tfoot id="tfootMath"></tfoot>
                    </table>
                </div>
            </div>
        </div>

        <div id="view-rad" class="tab-content">
            <div class="sheet-card">
                <div class="table-responsive">
                    <table id="tableRad">
                        <thead>
                            <tr>
                                <th rowspan="2" class="col-sticky-1">ลำดับ</th>
                                <th rowspan="2" class="col-sticky-2">ชื่อ - นามสกุล</th>
                                <th rowspan="2" style="min-width:180px;">มหาวิทยาลัย</th>
                                <th rowspan="2" style="min-width:180px;">สาขา</th>
                                <th colspan="3" class="th-group">IR Properties</th>
                                <th colspan="4" class="th-group">Interactions of IR</th>
                                <th colspan="4" class="th-group">Sources/X-ray</th>
                                <th colspan="4" class="th-group">Radioactivity</th>
                                <th colspan="3" class="th-group">Protection</th>
                            </tr>
                            <tr>
                                <th>23</th><th>24</th><th>25</th><th>26</th><th>27</th><th>28</th>
                                <th>29</th><th>30</th><th>31</th><th>32</th><th>33</th><th>34</th>
                                <th>35</th><th>36</th><th>37</th><th>38</th><th>39</th><th>40</th>
                            </tr>
                        </thead>
                        <tbody id="tbodyRad"></tbody>
                        <tfoot id="tfootRad"></tfoot>
                    </table>
                </div>
            </div>
        </div>

        <div id="view-eng" class="tab-content">
            <div class="sheet-card">
                <div class="table-responsive">
                    <table id="tableEng">
                        <thead>
                            <tr>
                                <th rowspan="2" class="col-sticky-1">ลำดับ</th>
                                <th rowspan="2" class="col-sticky-2">ชื่อ - นามสกุล</th>
                                <th rowspan="2" style="min-width:180px;">มหาวิทยาลัย</th>
                                <th rowspan="2" style="min-width:180px;">สาขา</th>
                                <th colspan="3" class="th-group" style="background:var(--eng-bg) !important; color:var(--eng-color);">ENGLISH PROFICIENCY TEST</th>
                            </tr>
                            <tr>
                                <th style="background:#f8f5ff; color:#5f3dc4;">Reading</th>
                                <th style="background:#f8f5ff; color:#5f3dc4;">Writing</th>
                                <th style="background:#f3f0ff; color:#4c2889; font-weight:800;">Total</th>
                            </tr>
                        </thead>
                        <tbody id="tbodyEng"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="view-grp" class="tab-content">
            <div class="sheet-card">
                <div class="table-responsive">
                    <table id="tableGrp">
                        <thead>
                            <tr>
                                <th rowspan="2" class="col-sticky-1">ลำดับ</th>
                                <th rowspan="2" class="col-sticky-2">ชื่อ - นามสกุล</th>
                                <th rowspan="2" style="min-width:180px;">มหาวิทยาลัย</th>
                                <th rowspan="2" style="min-width:180px;">สาขา</th>
                                <th colspan="6" class="th-group" style="background:var(--grp-bg) !important; color:var(--grp-color);">Group Assessment (Average)</th>
                            </tr>
                            <tr>
                                <th style="background:#f8f5ff; color:#5f3dc4;">Teamwork<br>(5)</th>
                                <th style="background:#f8f5ff; color:#5f3dc4;">Communication<br>(5)</th>
                                <th style="background:#f8f5ff; color:#5f3dc4;">System Thinking<br>(5)</th>
                                <th style="background:#f8f5ff; color:#5f3dc4;">Question & Answer<br>(5)</th>
                                <th style="background:#f8f5ff; color:#5f3dc4;">Attitude<br>(5)</th>
                                <th style="background:#f3f0ff; color:#4c2889; font-weight:800;">Total<br>(25)</th>
                            </tr>
                        </thead>
                        <tbody id="tbodyGrp"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="view-sum" class="tab-content">
            <div class="sheet-card">
                <div class="table-responsive">
                    <table id="tableSum">
                        <thead>
                            <tr>
                                <th rowspan="2" class="col-sticky-1">ลำดับ</th>
                                <th rowspan="2" class="col-sticky-2">ชื่อ - นามสกุล</th>
                                <th rowspan="2" style="min-width:180px;">มหาวิทยาลัย</th>
                                <th rowspan="2" style="min-width:180px;">สาขา</th>
                                <th colspan="4" class="th-group" style="background:#F0F4FF !important; color:#3F64E3;">Physics (12)</th>
                                <th colspan="4" class="th-group" style="background:#F2FBF6 !important; color:#129C52;">Math (10)</th>
                                <th colspan="6" class="th-group" style="background:#FFF6F0 !important; color:#E57125;">Radiation (18)</th>
                                <th rowspan="2" style="background:#FEF2F2; color:#DC2626;">Total (40)</th>
                                <th colspan="3" class="th-group" style="background:var(--eng-bg) !important; color:var(--eng-color);">English Test</th>
                            </tr>
                            <tr>
                                <th>Mech</th><th>EM</th><th>QM</th><th style="font-weight:800;">รวม</th>
                                <th>Cal</th><th>Lin</th><th>Prob</th><th style="font-weight:800;">รวม</th>
                                <th>Prop</th><th>Int</th><th>Src</th><th>Act</th><th>Prot</th><th style="font-weight:800;">รวม</th>
                                <th style="color:#5f3dc4;">Read</th><th style="color:#5f3dc4;">Write</th><th style="font-weight:800; background:#f3f0ff; color:#4c2889;">Total</th>
                            </tr>
                        </thead>
                        <tbody id="tbodySum"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="view-final" class="tab-content">
            <div class="sheet-card">
                <div class="table-responsive">
                    <table id="tableFinal">
                        <thead id="theadFinal">
                            </thead>
                        <tbody id="tbodyFinal"></tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>

    <script type="module" src="written_exam_report.js"></script>
        
    </script>
</body>
</html>